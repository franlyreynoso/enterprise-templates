# Simple Makefile that delegates to PowerShell scripts
ENV ?= dev

help:
	@powershell -NoProfile -Command "Write-Host 'üöÄ Enterprise Fullstack Orchestrator' -ForegroundColor Green; Write-Host 'Available commands:'; Write-Host '  make up-fullstack - Start complete environment'; Write-Host '  make down - Stop all services'; Write-Host '  make health - Check project status'"

up-fullstack:
	@powershell -NoProfile -Command "if (-not (Test-Path 'UI')) { Write-Error 'UI project not found. Run setup.ps1 first' } else { Write-Host 'Starting fullstack environment...' -ForegroundColor Green; $$env:COMPOSE_PROFILES='fullstack'; docker compose --env-file .env.$(ENV) -f docker-compose.fullstack.yml up -d; Write-Host 'Environment started! UI: http://localhost:3000 API: http://localhost:5000' -ForegroundColor Cyan }"

up-dev:
	@$(MAKE) up-fullstack ENV=dev

up-staging:
	@$(MAKE) up-fullstack ENV=staging

down:
	@powershell -NoProfile -Command "Write-Host 'Stopping services...' -ForegroundColor Red; docker compose -f docker-compose.fullstack.yml down"

health:
	@powershell -NoProfile -Command "if (Test-Path 'UI') { Write-Host 'UI project: ‚úÖ' -ForegroundColor Green } else { Write-Host 'UI project: ‚ùå' -ForegroundColor Red }; if (Test-Path 'API') { Write-Host 'API project: ‚úÖ' -ForegroundColor Green } else { Write-Host 'API project: ‚ùå' -ForegroundColor Red }"

.PHONY: help up-fullstack up-dev up-staging down health
.DEFAULT_GOAL := help